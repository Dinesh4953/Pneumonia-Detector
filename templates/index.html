<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PneumoScan AI</title>

<style>
.flash-error {
    border-left: 6px solid #dc2626;
    background: #fee2e2;
    color: #7f1d1d;
    padding: 18px 20px;
    border-radius: 10px;
    font-size: 15px;
    margin-bottom: 20px;
    box-shadow: 0 8px 20px rgba(220,38,38,0.15);
}

.flash-warning {
    border-left: 6px solid #f59e0b;
    background: #fffbeb;
    color: #92400e;
    padding: 18px 20px;
    border-radius: 10px;
    font-size: 15px;
    margin-bottom: 20px;
}

body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #f8fafc;
    color: #1f2937;
}

header {
    background: linear-gradient(90deg, #0f766e, #2563eb);
    color: white;
    padding: 50px 20px;
    text-align: center;
}

header h1 {
    margin: 0;
    font-size: 36px;
}

header p {
    margin-top: 10px;
    font-size: 18px;
}

.container {
    max-width: 1100px;
    margin: auto;
    padding: 40px 20px;
}

.card {
    background: white;
    border-radius: 10px;
    padding: 25px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.05);
    margin-bottom: 25px;
}

.grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 30px;
}

button {
    background: #2563eb;
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 15px;
}

button:hover {
    background: #1d4ed8;
}

.result-tag {
    display: inline-block;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 14px;
    margin-top: 10px;
}

.high { background:#fee2e2; color:#991b1b; }
.medium { background:#fef3c7; color:#92400e; }
.low { background:#dcfce7; color:#166534; }

.conf-bar {
    height: 14px;
    background: #e5e7eb;
    border-radius: 10px;
    overflow: hidden;
    margin-top: 10px;
}

.conf-fill {
    height: 100%;
    background: linear-gradient(90deg, #22c55e, #facc15, #ef4444);
}

img {
    max-width: 100%;
    border-radius: 8px;
}

footer {
    text-align: center;
    padding: 30px;
    font-size: 13px;
    color: #6b7280;
}

/* INFO SECTION */
.info-container {
    max-width: 900px;
    margin: auto;
}

.info-container h2 {
    text-align: center;
    margin-bottom: 25px;
}

.info-card {
    background: #f8fafc;
    border-left: 5px solid #2563eb;
    padding: 15px 20px;
    margin-bottom: 15px;
    border-radius: 6px;
}

.info-card h3 {
    margin-top: 0;
    color: #1e40af;
}

.disclaimer {
    margin-top: 20px;
    padding: 15px;
    background: #fff7ed;
    border-left: 5px solid #f97316;
    border-radius: 6px;
    font-size: 14px;
    color: #7c2d12;
}

/* FLASH ERROR */
.error-card {
    border-left:5px solid #dc2626;
    background:#fee2e2;
}

.warning-card {
    border-left: 5px solid #f59e0b;
    background: #fffbeb;
    color: #92400e;
}

</style>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

</head>

<body>

<header>
    <h1>PneumoScan AI</h1>
    <p>Explainable AI-assisted pneumonia analysis from chest X-ray images</p>
</header>

<div class="container">

<!-- ================== PNEUMONIA AWARENESS ================== -->
<div class="info-container">

  <h2>ü´Å Pneumonia Awareness</h2>

  <div class="info-card">
    <h3>What is Pneumonia?</h3>
    <p>Pneumonia is a lung infection that inflames air sacs, causing breathing difficulty and reduced oxygen intake.</p>
  </div>

  <div class="info-card">
    <h3>How It Affects the Body</h3>
    <ul>
      <li>Difficulty in breathing</li>
      <li>Chest pain and fatigue</li>
      <li>Reduced oxygen levels</li>
    </ul>
  </div>

  <div class="info-card">
    <h3>Prevention & Safety</h3>
    <ul>
      <li>Vaccination</li>
      <li>Good hygiene</li>
      <li>Avoid smoking</li>
      <li>Early medical consultation</li>
    </ul>
  </div>

  <div class="disclaimer">
    ‚ö†Ô∏è <b>Disclaimer:</b> This AI system is for educational purposes only and does not replace medical diagnosis.
  </div>

</div>

<br>

<!-- ================== FLASH ERROR MESSAGE ================== -->
<div id="response-section"></div>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div id="flash-container">
      {% for category, message in messages %}
        <div class="{% if category == 'error' %}flash-error{% else %}flash-warning{% endif %}">
            <b>{{ category|capitalize }}:</b> {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}



<!-- ================== UPLOAD & RESULT ================== -->
<div class="grid">

<div class="card">
    <h3>Upload Chest X-ray</h3>
    <form method="POST" enctype="multipart/form-data">
        <input type="file" name="image" required><br><br>
        <button type="submit">Analyze Image</button>
    </form>
</div>

{% if image_path %}
<div class="card shadow-sm">
    <h3 class="mb-3">ü©ª Uploaded Chest X-ray</h3>

    <div style="display:flex; justify-content:center;">
        <img 
            src="{{ image_path }}" 
            alt="Uploaded Chest X-ray"
            style="
                max-width:100%;
                width:360px;
                border-radius:10px;
                box-shadow:0 8px 20px rgba(0,0,0,0.15);
            "
        >
    </div>

    <small style="display:block; text-align:center; margin-top:10px; color:#6b7280;">
        Image used for AI analysis
    </small>
</div>
{% endif %}


{% if prediction %}
<div class="card shadow-sm">
    <h3 class="mb-3">üß† AI Reasoning Summary</h3>

    <div style="display:grid; gap:10px; font-size:15px;">
        {% for reason in explanation %}
        <div style="display:flex; align-items:center; gap:10px;">
            <span style="font-size:18px;">‚úîÔ∏è</span>
            <span>{{ reason }}</span>
        </div>
        {% endfor %}
    </div>

    <hr>

    <div style="display:flex; gap:20px; flex-wrap:wrap;">
        <div>
            <b>Severity:</b>
            <span class="result-tag
            {% if severity == 'Severe' %}high
            {% elif severity == 'Moderate' %}medium
            {% else %}low{% endif %}">
            {{ severity }}
            </span>
        </div>

        <div>
            <b>AI Reliability:</b>
            <span style="color:#2563eb; font-weight:600;">
                {{ reliability }}
            </span>
        </div>
    </div>
</div>
{% endif %}





{% if prediction %}
<div class="card" id="result-section">
    <h3>Prediction Result</h3>
    <p><b>Diagnosis:</b> {{ prediction }}</p>
<p><b>Pneumonia Probability (AI-estimated):</b> {{ confidence | round(2) }}%</p>
<small>
This probability represents the AI model‚Äôs confidence that the uploaded chest X-ray
contains pneumonia-related patterns.
</small>
    <div class="conf-bar">
<div class="conf-fill" style="width: {{ confidence | round(0) }}%;"></div>
    </div>

    {% if confidence > 60 %}
        <span class="result-tag high">High likelihood</span>
    {% elif confidence > 30 %}
        <span class="result-tag medium">Moderate likelihood</span>
    {% else %}
        <span class="result-tag low">Low likelihood</span>
    {% endif %}
</div>
{% endif %}

</div>


   <!-- ================== RISK INTERPRETATION GUIDE ================== -->
<div class="card shadow-sm">
    <h3 class="mb-2">üìä Risk Interpretation Guide</h3>
    <p style="font-size:14px; color:#4b5563;">
        AI confidence is mapped to risk categories:
    </p>

    <div style="display:grid; gap:12px; margin-top:15px;">

        <div style="padding:12px; border-radius:8px; background:#ecfdf5; display:flex; align-items:center; gap:12px;">
            <span style="font-size:18px;">üü¢</span>
            <div>
                <b>Low Risk</b><br>
                <small>Confidence &lt; 30%</small>
            </div>
        </div>

        <div style="padding:12px; border-radius:8px; background:#fffbeb; display:flex; align-items:center; gap:12px;">
            <span style="font-size:18px;">üü°</span>
            <div>
                <b>Moderate Risk</b><br>
                <small>Confidence 30% ‚Äì 74%</small>
            </div>
        </div>

        <div style="padding:12px; border-radius:8px; background:#fef2f2; display:flex; align-items:center; gap:12px;">
            <span style="font-size:18px;">üî¥</span>
            <div>
                <b>High Risk</b><br>
                <small>Confidence ‚â• 75%</small>
            </div>
        </div>

    </div>
    <small style="color:#6b7280; display:block; margin-top:12px;">
        This guide is fixed and shown before analysis.
    </small>
</div>


<div class="card">
    <h3>Explainable AI</h3>
    <p>
        During model development, Grad-CAM was used to visualize lung regions
        influencing predictions.
        <br><br>
        For deployment, a TensorFlow Lite optimized model is used to ensure
        low memory usage and fast inference.
    </p>
</div>





<!-- Model Info -->
<div class="card">
    <h3>Model Transparency</h3>
    <ul>
        <li>Architecture: ResNet50 (Transfer Learning)</li>
        <li>Dataset: Chest X-ray Pneumonia (Kaggle)</li>
        <li>Test Accuracy: ~87%</li>
        <li>Explainability: Grad-CAM visualization</li>
    </ul>
</div>

<!-- Medical Awareness -->
<div class="card">
    <h3>Medical Awareness</h3>
    <b>Common Symptoms</b>
    <ul>
        <li>Persistent cough</li>
        <li>Fever or chills</li>
        <li>Shortness of breath</li>
        <li>Chest pain</li>
    </ul>

    <b>When to Consult a Doctor</b>
    <p>If symptoms worsen or breathing becomes difficult, seek immediate medical care.</p>
</div>

{% if prediction %}
<div class="card">
    <a href="{{ pdf_path }}" target="_blank">
        <button>Download Medical Report (PDF)</button>
    </a>
</div>
{% endif %}

</div>

<footer>
‚ö†Ô∏è This system is for educational and research purposes only.
</footer>
{% if prediction %}

<script>
  window.onload = function () {
    const resultSection = document.getElementById("result-section");
    const responseSection = document.getElementById("response-section");

    if (responseSection) {
      responseSection.scrollIntoView({ behavior: "smooth" });
    } else if (resultSection) {
      resultSection.scrollIntoView({ behavior: "smooth" });
    }
  };
</script>

{% endif %}
<script>
document.addEventListener("DOMContentLoaded", function () {
    const flashBox = document.getElementById("flash-container");
    if (flashBox) {
        flashBox.scrollIntoView({ behavior: "smooth", block: "center" });
    }
});
</script>


</body>
</html>
this logic is total ok but arrane them in neat order when some one upload an image and it is getting error for invalid image but not in red and not getting auto scroll for invalid image